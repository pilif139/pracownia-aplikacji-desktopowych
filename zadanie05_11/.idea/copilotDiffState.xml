<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/components/tools/contrast/ContrastTools.cpp">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/components/tools/contrast/ContrastTools.cpp" />
              <option name="originalContent" value="//&#10;// Created by Filip on 18/11/2025.&#10;//&#10;&#10;#include &quot;ContrastTools.h&quot;&#10;#include &lt;cmath&gt;&#10;#include &lt;algorithm&gt;&#10;&#10;void ContrastTools::applyLinear(uint8_t** data, int width, int height, double contrast) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0) return;&#10;    contrast = std::clamp(contrast, -1.0, 1.0);&#10;&#10;    // Standard contrast formula: f(x) = factor * (x - 128) + 128&#10;    // factor = (259 * (contrast*255 + 255)) / (255 * (259 - contrast*255))&#10;    double c255 = contrast * 255.0;&#10;    double factor = (259.0 * (c255 + 255.0)) / (255.0 * (259.0 - c255));&#10;&#10;    int rowSize = width * 3; // RGB&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            int v = row[c];&#10;            int out = static_cast&lt;int&gt;(std::round(factor * (v - 128) + 128));&#10;            row[c] = static_cast&lt;uint8_t&gt;(std::clamp(out, 0, 255));&#10;        }&#10;    }&#10;}&#10;&#10;void ContrastTools::applyLogarithmic(uint8_t** data, int width, int height, double k) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0 || k &lt;= 0.0) return;&#10;&#10;    double denom = std::log1p(k); // log(1 + k)&#10;    int rowSize = width * 3;&#10;&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            double v = static_cast&lt;double&gt;(row[c]) / 255.0; // normalize to [0,1]&#10;            double mapped = std::log1p(k * v) / denom; // log mapping&#10;            int out = static_cast&lt;int&gt;(std::round(mapped * 255.0));&#10;            row[c] = static_cast&lt;uint8_t&gt;(std::clamp(out, 0, 255));&#10;        }&#10;    }&#10;}&#10;&#10;void ContrastTools::applyExponential(uint8_t** data, int width, int height, double k) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0 || k &lt;= 1e-12) return;&#10;&#10;    double expk = std::exp(k);&#10;    double denom = expk - 1.0;&#10;    int rowSize = width * 3;&#10;&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            double v = static_cast&lt;double&gt;(row[c]) / 255.0; // normalize to [0,1]&#10;            double mapped = (std::exp(k * v) - 1.0) / denom; // exponential mapping&#10;            int out = static_cast&lt;int&gt;(std::round(mapped * 255.0));&#10;            row[c] = static_cast&lt;uint8_t&gt;(std::clamp(out, 0, 255));&#10;        }&#10;    }&#10;}&#10;&#10;void ContrastTools::applyLookupTable(uint8_t** data, int width, int height, const std::vector&lt;uint8_t&gt;&amp; lut) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0 || lut.size() != 256) return;&#10;    &#10;    int rowSize = width * 3;&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            row[c] = lut[row[c]];&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="//&#10;// Created by Filip on 18/11/2025.&#10;//&#10;&#10;#include &quot;ContrastTools.h&quot;&#10;#include &lt;cmath&gt;&#10;#include &lt;algorithm&gt;&#10;&#10;void ContrastTools::applyLinear(uint8_t** data, int width, int height, double contrast) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0) return;&#10;    contrast = std::clamp(contrast, -1.0, 1.0);&#10;&#10;    // Standard contrast formula: f(x) = factor * (x - 128) + 128&#10;    // factor = (259 * (contrast*255 + 255)) / (255 * (259 - contrast*255))&#10;    double c255 = contrast * 255.0;&#10;    double factor = (259.0 * (c255 + 255.0)) / (255.0 * (259.0 - c255));&#10;&#10;    int rowSize = width * 3; // RGB&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            int v = row[c];&#10;            int out = static_cast&lt;int&gt;(std::round(factor * (v - 128) + 128));&#10;            row[c] = static_cast&lt;uint8_t&gt;(std::clamp(out, 0, 255));&#10;        }&#10;    }&#10;}&#10;&#10;void ContrastTools::applyLogarithmic(uint8_t** data, int width, int height, double k) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0 || k &lt;= 0.0) return;&#10;&#10;    double denom = std::log1p(k); // log(1 + k)&#10;    int rowSize = width * 3;&#10;&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            double v = static_cast&lt;double&gt;(row[c]) / 255.0; // normalize to [0,1]&#10;            double mapped = std::log1p(k * v) / denom; // log mapping&#10;            int out = static_cast&lt;int&gt;(std::round(mapped * 255.0));&#10;            row[c] = static_cast&lt;uint8_t&gt;(std::clamp(out, 0, 255));&#10;        }&#10;    }&#10;}&#10;&#10;void ContrastTools::applyExponential(uint8_t** data, int width, int height, double k) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0 || k &lt;= 1e-12) return;&#10;&#10;    double expk = std::exp(k);&#10;    double denom = expk - 1.0;&#10;    int rowSize = width * 3;&#10;&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            double v = static_cast&lt;double&gt;(row[c]) / 255.0; // normalize to [0,1]&#10;            double mapped = (std::exp(k * v) - 1.0) / denom; // exponential mapping&#10;            int out = static_cast&lt;int&gt;(std::round(mapped * 255.0));&#10;            row[c] = static_cast&lt;uint8_t&gt;(std::clamp(out, 0, 255));&#10;        }&#10;    }&#10;}&#10;&#10;void ContrastTools::applyLookupTable(uint8_t** data, int width, int height, const std::vector&lt;uint8_t&gt;&amp; lut) {&#10;    if (!data || width &lt;= 0 || height &lt;= 0 || lut.size() != 256) return;&#10;    &#10;    int rowSize = width * 3;&#10;    for (int r = 0; r &lt; height; ++r) {&#10;        uint8_t* row = data[r];&#10;        for (int c = 0; c &lt; rowSize; ++c) {&#10;            row[c] = lut[row[c]];&#10;        }&#10;    }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>